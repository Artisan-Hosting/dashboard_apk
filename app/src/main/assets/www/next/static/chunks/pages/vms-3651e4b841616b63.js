(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[526],{6717:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/vms",function(){return s(9201)}])},9201:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(7876),a=s(4232),n=s(1059),c=s(767),l=s(3780),i=s(1799),o=s(7685);function d(){let[e,t]=(0,a.useState)([]),[s,d]=(0,a.useState)(!0),m=(0,a.useRef)({}),[u,x]=(0,a.useState)({}),h=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let s=await (0,n.QQ)();if(!s)return;e?s.forEach(e=>{let t=m.current[e.vmid];t&&t!==e.status&&(0,o.oR)("VM ".concat(e.vmid," is now ").concat(e.status),{icon:"running"===e.status?"✅":"⚠️"}),m.current[e.vmid]=e.status}):s.forEach(e=>{m.current[e.vmid]=e.status}),t(s)}catch(t){console.error(e?"Error refreshing VMs:":"Error fetching VMs",t)}finally{e||d(!1)}},[]);(0,a.useEffect)(()=>{h(!1)},[h]),(0,a.useEffect)(()=>{let e=setInterval(()=>h(!0),5e3);return()=>clearInterval(e)},[h]);let p=async()=>{await h(!0)},f=async(e,t)=>{x(t=>({...t,[e]:!0}));try{await (0,n.mU)(e,t),await p()}catch(s){console.error("Failed to ".concat(t," VM ").concat(e,":"),s)}finally{x(t=>({...t,[e]:!1}))}};return(0,r.jsxs)("div",{className:"relative min-h-screen flex bg-page text-foreground",children:[(0,r.jsx)(o.l$,{position:"bottom-right"}),(0,r.jsx)(c.B,{onLogout:i.v,onLogoutAll:i.u}),(0,r.jsxs)("main",{className:"flex-1 p-4 sm:p-6 lg:p-8",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-brand",children:"Virtual Machines"}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:e.map(e=>{var t;let s=null!=(t=u[e.vmid])&&t;return(0,r.jsxs)("div",{className:"card-hover p-6",children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold text-brand",children:["VM ",e.vmid]}),(0,r.jsx)("p",{className:"text-sm mt-1 ".concat("running"===e.status?"text-green-400":"text-red-400"),children:e.status.toUpperCase()}),e.metrics&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-300 space-y-1 mb-4",children:[(0,r.jsxs)("p",{children:["CPU: ",e.metrics.cpu_percent.toFixed(1),"%"]}),(0,r.jsxs)("p",{children:["RAM: ",e.metrics.memory_percent.toFixed(1),"%"]}),(0,r.jsxs)("p",{children:["Uptime: ",e.metrics.uptime_seconds,"s"]})]}),(0,r.jsx)("div",{className:"mt-4 flex flex-wrap gap-2",children:["start","stop","reboot","shutdown"].map(t=>(0,r.jsx)("button",{onClick:()=>f(e.vmid,t),disabled:s,className:"\n                          flex-1\n                          px-3 py-1 text-sm font-medium rounded-full\n                          ".concat(s?"bg-gray-500 cursor-not-allowed":"bg-brand hover:bg-brand-dark","\n                        "),children:t.charAt(0).toUpperCase()+t.slice(1)},t))})]},e.vmid)})})]}),s&&(0,r.jsx)(l.A,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[560,636,593,792],()=>t(6717)),_N_E=e.O()}]);